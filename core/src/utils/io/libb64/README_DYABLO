adapted from libsc (C. Burstedde, https://github.com/cburstedde/libsc under LGPL)
